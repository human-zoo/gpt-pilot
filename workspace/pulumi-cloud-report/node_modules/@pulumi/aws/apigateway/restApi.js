"use strict";
// *** WARNING: this file was generated by the Pulumi Terraform Bridge (tfgen) Tool. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***
Object.defineProperty(exports, "__esModule", { value: true });
exports.RestApi = void 0;
const pulumi = require("@pulumi/pulumi");
const utilities = require("../utilities");
/**
 * Manages an API Gateway REST API. The REST API can be configured via [importing an OpenAPI specification](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-import-api.html) in the `body` argument (with other arguments serving as overrides) or via other provider resources to manage the resources (`aws.apigateway.Resource` resource), methods (`aws.apigateway.Method` resource), integrations (`aws.apigateway.Integration` resource), etc. of the REST API. Once the REST API is configured, the `aws.apigateway.Deployment` resource can be used along with the `aws.apigateway.Stage` resource to publish the REST API.
 *
 * > **Note:** Amazon API Gateway Version 1 resources are used for creating and deploying REST APIs. To create and deploy WebSocket and HTTP APIs, use Amazon API Gateway Version 2 resources.
 *
 * !> **WARN:** When importing Open API Specifications with the `body` argument, by default the API Gateway REST API will be replaced with the Open API Specification thus removing any existing methods, resources, integrations, or endpoints. Endpoint mutations are asynchronous operations, and race conditions with DNS are possible. To overcome this limitation, use the `putRestApiMode` attribute and set it to `merge`.
 *
 * ## Example Usage
 *
 * ### OpenAPI Specification
 *
 * <!--Start PulumiCodeChooser -->
 * ```typescript
 * import * as pulumi from "@pulumi/pulumi";
 * import * as aws from "@pulumi/aws";
 * import * as std from "@pulumi/std";
 *
 * const example = new aws.apigateway.RestApi("example", {
 *     body: JSON.stringify({
 *         openapi: "3.0.1",
 *         info: {
 *             title: "example",
 *             version: "1.0",
 *         },
 *         paths: {
 *             "/path1": {
 *                 get: {
 *                     "x-amazon-apigateway-integration": {
 *                         httpMethod: "GET",
 *                         payloadFormatVersion: "1.0",
 *                         type: "HTTP_PROXY",
 *                         uri: "https://ip-ranges.amazonaws.com/ip-ranges.json",
 *                     },
 *                 },
 *             },
 *         },
 *     }),
 *     name: "example",
 *     endpointConfiguration: {
 *         types: "REGIONAL",
 *     },
 * });
 * const exampleDeployment = new aws.apigateway.Deployment("example", {
 *     restApi: example.id,
 *     triggers: {
 *         redeployment: std.sha1Output({
 *             input: pulumi.jsonStringify(example.body),
 *         }).apply(invoke => invoke.result),
 *     },
 * });
 * const exampleStage = new aws.apigateway.Stage("example", {
 *     deployment: exampleDeployment.id,
 *     restApi: example.id,
 *     stageName: "example",
 * });
 * ```
 * <!--End PulumiCodeChooser -->
 *
 * ### OpenAPI Specification with Private Endpoints
 *
 * Using `putRestApiMode` = `merge` when importing the OpenAPI Specification, the AWS control plane will not delete all existing literal properties that are not explicitly set in the OpenAPI definition. Impacted API Gateway properties: ApiKeySourceType, BinaryMediaTypes, Description, EndpointConfiguration, MinimumCompressionSize, Name, Policy).
 *
 * <!--Start PulumiCodeChooser -->
 * ```typescript
 * import * as pulumi from "@pulumi/pulumi";
 * import * as aws from "@pulumi/aws";
 * import * as std from "@pulumi/std";
 *
 * const available = aws.getAvailabilityZones({
 *     state: "available",
 *     filters: [{
 *         name: "opt-in-status",
 *         values: ["opt-in-not-required"],
 *     }],
 * });
 * const current = aws.getRegion({});
 * const example = new aws.ec2.Vpc("example", {
 *     cidrBlock: "10.0.0.0/16",
 *     enableDnsSupport: true,
 *     enableDnsHostnames: true,
 * });
 * const exampleDefaultSecurityGroup = new aws.ec2.DefaultSecurityGroup("example", {vpcId: example.id});
 * const exampleSubnet = new aws.ec2.Subnet("example", {
 *     availabilityZone: available.then(available => available.names?.[0]),
 *     cidrBlock: example.cidrBlock.apply(cidrBlock => std.cidrsubnetOutput({
 *         input: cidrBlock,
 *         newbits: 8,
 *         netnum: 0,
 *     })).apply(invoke => invoke.result),
 *     vpcId: example.id,
 * });
 * const exampleVpcEndpoint: aws.ec2.VpcEndpoint[] = [];
 * for (const range = {value: 0}; range.value < 3; range.value++) {
 *     exampleVpcEndpoint.push(new aws.ec2.VpcEndpoint(`example-${range.value}`, {
 *         privateDnsEnabled: false,
 *         securityGroupIds: [exampleDefaultSecurityGroup.id],
 *         serviceName: current.then(current => `com.amazonaws.${current.name}.execute-api`),
 *         subnetIds: [exampleSubnet.id],
 *         vpcEndpointType: "Interface",
 *         vpcId: example.id,
 *     }));
 * }
 * const exampleRestApi = new aws.apigateway.RestApi("example", {
 *     body: JSON.stringify({
 *         openapi: "3.0.1",
 *         info: {
 *             title: "example",
 *             version: "1.0",
 *         },
 *         paths: {
 *             "/path1": {
 *                 get: {
 *                     "x-amazon-apigateway-integration": {
 *                         httpMethod: "GET",
 *                         payloadFormatVersion: "1.0",
 *                         type: "HTTP_PROXY",
 *                         uri: "https://ip-ranges.amazonaws.com/ip-ranges.json",
 *                     },
 *                 },
 *             },
 *         },
 *     }),
 *     name: "example",
 *     putRestApiMode: "merge",
 *     endpointConfiguration: {
 *         types: "PRIVATE",
 *         vpcEndpointIds: [
 *             exampleVpcEndpoint[0].id,
 *             exampleVpcEndpoint[1].id,
 *             exampleVpcEndpoint[2].id,
 *         ],
 *     },
 * });
 * const exampleDeployment = new aws.apigateway.Deployment("example", {
 *     restApi: exampleRestApi.id,
 *     triggers: {
 *         redeployment: std.sha1Output({
 *             input: pulumi.jsonStringify(exampleRestApi.body),
 *         }).apply(invoke => invoke.result),
 *     },
 * });
 * const exampleStage = new aws.apigateway.Stage("example", {
 *     deployment: exampleDeployment.id,
 *     restApi: exampleRestApi.id,
 *     stageName: "example",
 * });
 * ```
 * <!--End PulumiCodeChooser -->
 *
 * ### Resources
 *
 * <!--Start PulumiCodeChooser -->
 * ```typescript
 * import * as pulumi from "@pulumi/pulumi";
 * import * as aws from "@pulumi/aws";
 * import * as std from "@pulumi/std";
 *
 * const example = new aws.apigateway.RestApi("example", {name: "example"});
 * const exampleResource = new aws.apigateway.Resource("example", {
 *     parentId: example.rootResourceId,
 *     pathPart: "example",
 *     restApi: example.id,
 * });
 * const exampleMethod = new aws.apigateway.Method("example", {
 *     authorization: "NONE",
 *     httpMethod: "GET",
 *     resourceId: exampleResource.id,
 *     restApi: example.id,
 * });
 * const exampleIntegration = new aws.apigateway.Integration("example", {
 *     httpMethod: exampleMethod.httpMethod,
 *     resourceId: exampleResource.id,
 *     restApi: example.id,
 *     type: "MOCK",
 * });
 * const exampleDeployment = new aws.apigateway.Deployment("example", {
 *     restApi: example.id,
 *     triggers: {
 *         redeployment: std.sha1Output({
 *             input: pulumi.jsonStringify([
 *                 exampleResource.id,
 *                 exampleMethod.id,
 *                 exampleIntegration.id,
 *             ]),
 *         }).apply(invoke => invoke.result),
 *     },
 * });
 * const exampleStage = new aws.apigateway.Stage("example", {
 *     deployment: exampleDeployment.id,
 *     restApi: example.id,
 *     stageName: "example",
 * });
 * ```
 * <!--End PulumiCodeChooser -->
 *
 * ## Import
 *
 * Using `pulumi import`, import `aws_api_gateway_rest_api` using the REST API ID. For example:
 *
 * ```sh
 * $ pulumi import aws:apigateway/restApi:RestApi example 12345abcde
 * ```
 * ~> __NOTE:__ Resource import does not currently support the `body` attribute.
 */
class RestApi extends pulumi.CustomResource {
    /**
     * Get an existing RestApi resource's state with the given name, ID, and optional extra
     * properties used to qualify the lookup.
     *
     * @param name The _unique_ name of the resulting resource.
     * @param id The _unique_ provider ID of the resource to lookup.
     * @param state Any extra arguments used during the lookup.
     * @param opts Optional settings to control the behavior of the CustomResource.
     */
    static get(name, id, state, opts) {
        return new RestApi(name, state, Object.assign(Object.assign({}, opts), { id: id }));
    }
    /**
     * Returns true if the given object is an instance of RestApi.  This is designed to work even
     * when multiple copies of the Pulumi SDK have been loaded into the same process.
     */
    static isInstance(obj) {
        if (obj === undefined || obj === null) {
            return false;
        }
        return obj['__pulumiType'] === RestApi.__pulumiType;
    }
    constructor(name, argsOrState, opts) {
        let resourceInputs = {};
        opts = opts || {};
        if (opts.id) {
            const state = argsOrState;
            resourceInputs["apiKeySource"] = state ? state.apiKeySource : undefined;
            resourceInputs["arn"] = state ? state.arn : undefined;
            resourceInputs["binaryMediaTypes"] = state ? state.binaryMediaTypes : undefined;
            resourceInputs["body"] = state ? state.body : undefined;
            resourceInputs["createdDate"] = state ? state.createdDate : undefined;
            resourceInputs["description"] = state ? state.description : undefined;
            resourceInputs["disableExecuteApiEndpoint"] = state ? state.disableExecuteApiEndpoint : undefined;
            resourceInputs["endpointConfiguration"] = state ? state.endpointConfiguration : undefined;
            resourceInputs["executionArn"] = state ? state.executionArn : undefined;
            resourceInputs["failOnWarnings"] = state ? state.failOnWarnings : undefined;
            resourceInputs["minimumCompressionSize"] = state ? state.minimumCompressionSize : undefined;
            resourceInputs["name"] = state ? state.name : undefined;
            resourceInputs["parameters"] = state ? state.parameters : undefined;
            resourceInputs["policy"] = state ? state.policy : undefined;
            resourceInputs["putRestApiMode"] = state ? state.putRestApiMode : undefined;
            resourceInputs["rootResourceId"] = state ? state.rootResourceId : undefined;
            resourceInputs["tags"] = state ? state.tags : undefined;
            resourceInputs["tagsAll"] = state ? state.tagsAll : undefined;
        }
        else {
            const args = argsOrState;
            resourceInputs["apiKeySource"] = args ? args.apiKeySource : undefined;
            resourceInputs["binaryMediaTypes"] = args ? args.binaryMediaTypes : undefined;
            resourceInputs["body"] = args ? args.body : undefined;
            resourceInputs["description"] = args ? args.description : undefined;
            resourceInputs["disableExecuteApiEndpoint"] = args ? args.disableExecuteApiEndpoint : undefined;
            resourceInputs["endpointConfiguration"] = args ? args.endpointConfiguration : undefined;
            resourceInputs["failOnWarnings"] = args ? args.failOnWarnings : undefined;
            resourceInputs["minimumCompressionSize"] = args ? args.minimumCompressionSize : undefined;
            resourceInputs["name"] = args ? args.name : undefined;
            resourceInputs["parameters"] = args ? args.parameters : undefined;
            resourceInputs["policy"] = args ? args.policy : undefined;
            resourceInputs["putRestApiMode"] = args ? args.putRestApiMode : undefined;
            resourceInputs["tags"] = args ? args.tags : undefined;
            resourceInputs["arn"] = undefined /*out*/;
            resourceInputs["createdDate"] = undefined /*out*/;
            resourceInputs["executionArn"] = undefined /*out*/;
            resourceInputs["rootResourceId"] = undefined /*out*/;
            resourceInputs["tagsAll"] = undefined /*out*/;
        }
        opts = pulumi.mergeOptions(utilities.resourceOptsDefaults(), opts);
        super(RestApi.__pulumiType, name, resourceInputs, opts);
    }
}
exports.RestApi = RestApi;
/** @internal */
RestApi.__pulumiType = 'aws:apigateway/restApi:RestApi';
//# sourceMappingURL=restApi.js.map